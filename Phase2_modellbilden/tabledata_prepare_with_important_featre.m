%% Die wichtigen Parameter aus den Tabellen ablesen und in .mat* abspeichern
clear
clc
fileFolder = 'E:\Matlab Code\Workpart2_WTG';
dirOutput = dir(fileFolder);
filename = {dirOutput.name};
filename = filename(3:end);
for i = 1:numel(filename)
    disp(i)
    eval(['WTG',num2str(i),'=importfile("',filename{i},'");']); % Daten der ausgew?hlten Parameter ablesen
    eval(['WTG',num2str(i),'(1,:) = [];']);
end
save('E:\Matlab Code\Phase2_modellbilden\data\WTGx.mat','WTG*');


function WTG = importfile(filename, dataLines)
%IMPORTFILE1 Import data from a text file
%  WTG03 = IMPORTFILE1(FILENAME) reads data from text file FILENAME for
%  the default selection.  Returns the data as a table.
%
%  WTG = IMPORTFILE1(FILE, DATALINES) reads data for the specified row
%  interval(s) of text file FILENAME. Specify DATALINES as a positive
%  scalar integer or a N-by-2 array of positive scalar integers for
%  dis-contiguous row intervals.
%
%  Example:
%  WTG = importfile1("E:\Matlab Code\Workpart2_WTG\WTG03.csv", [2, Inf]);
%
%  See also READTABLE.
%
% Auto-generated by MATLAB on 2020-02-17 17:09:35

%% Input handling

% If dataLines is not specified, define defaults
if nargin < 2
    dataLines = [2, Inf];
end

%% Setup the Import Options and import the data
opts = delimitedTextImportOptions("NumVariables", 193);

% Specify range and delimiter
opts.DataLines = dataLines;
opts.Delimiter = ",";

% Specify column names and types
opts.VariableNames = ["Var1", "PCTimeStamp", "Gen_RPM_Max", "Gen_RPM_Min", "Gen_RPM_Avg", "Gen_RPM_Std", "Gen_Bear_Temp_Avg", "Gen_Phase1_Temp_Avg", "Gen_Phase2_Temp_Avg", "Gen_Phase3_Temp_Avg", "Hyd_Oil_Temp_Avg", "Gear_Oil_Temp_Avg", "Gear_Bear_Temp_Avg", "Nac_Temp_Avg", "Rtr_RPM_Max", "Rtr_RPM_Min", "Rtr_RPM_Avg", "Amb_WindSpeed_Max", "Amb_WindSpeed_Min", "Amb_WindSpeed_Avg", "Amb_WindSpeed_Std", "Amb_WindDir_Relative_Avg", "Amb_WindDir_Abs_Avg", "Amb_Temp_Avg", "Prod_LatestAvg_ActPwrGen0", "Prod_LatestAvg_ActPwrGen1", "Prod_LatestAvg_ActPwrGen2", "Prod_LatestAvg_TotActPwr", "Prod_LatestAvg_ReactPwrGen0", "Prod_LatestAvg_ReactPwrGen1", "Prod_LatestAvg_ReactPwrGen2", "Prod_LatestAvg_TotReactPwr", "HVTrafo_Phase1_Temp_Avg", "HVTrafo_Phase2_Temp_Avg", "HVTrafo_Phase3_Temp_Avg", "Grd_InverterPhase1_Temp_Avg", "Cont_Grnd_Temp_Avg", "Cont_Top_Temp_Avg", "Cont_Hub_Temp_Avg", "Cont_VCP_Temp_Avg", "Gen_SlipRing_Temp_Avg", "Spin_Temp_Avg", "Blds_PitchAngle_Min", "Blds_PitchAngle_Max", "Blds_PitchAngle_Avg", "Blds_PitchAngle_Std", "Cont_VCP_ChokcoilTemp_Avg", "Grd_RtrInvPhase1_Temp_Avg", "Grd_RtrInvPhase2_Temp_Avg", "Grd_RtrInvPhase3_Temp_Avg", "Cont_VCP_WtrTemp_Avg", "Grd_Prod_Pwr_Avg", "Grd_Prod_CosPhi_Avg", "Grd_Prod_Freq_Avg", "Grd_Prod_VoltPhse1_Avg", "Grd_Prod_VoltPhse2_Avg", "Grd_Prod_VoltPhse3_Avg", "Grd_Prod_CurPhse1_Avg", "Grd_Prod_CurPhse2_Avg", "Grd_Prod_CurPhse3_Avg", "Grd_Prod_Pwr_Max", "Grd_Prod_Pwr_Min", "Grd_Busbar_Temp_Avg", "HCnt_Avg_Tot", "HCnt_Avg_GrdOn", "HCnt_Avg_GrdOk", "HCnt_Avg_TrbOk", "HCnt_Avg_Run", "HCnt_Avg_Gen1", "HCnt_Avg_Gen2", "HCnt_Avg_Yaw", "HCnt_Avg_SrvOn", "HCnt_Avg_AmbOk", "HCnt_Avg_WindOk", "Rtr_RPM_Std", "Amb_WindSpeed_Est_Avg", "Grd_Prod_Pwr_Std", "Grd_Prod_ReactPwr_Avg", "Grd_Prod_ReactPwr_Max", "Grd_Prod_ReactPwr_Min", "Grd_Prod_ReactPwr_Std", "Grd_Prod_PsblePwr_Avg", "Grd_Prod_PsblePwr_Max", "Grd_Prod_PsblePwr_Min", "Grd_Prod_PsblePwr_Std", "Grd_Prod_PsbleInd_Avg", "Grd_Prod_PsbleInd_Max", "Grd_Prod_PsbleInd_Min", "Grd_Prod_PsbleInd_Std", "Grd_Prod_PsbleCap_Avg", "Grd_Prod_PsbleCap_Max", "Grd_Prod_PsbleCap_Min", "Grd_Prod_PsbleCap_Std", "Gen_Bear2_Temp_Avg", "Spin_Temp_SlipRing_Avg", "HCnt_Avg_AlarmAct", "Sys_Logs_FirstActAlarmNo", "Sys_Logs_FirstActAlarmPar1", "Sys_Logs_FirstActAlarmPar2", "Nac_Direction_Avg", "Grd_Sets_ActPwr_ReferenceValue10Min", "Grd_Sets_ActPwr_Source10Min", "Grd_Sets_ReactPwr_ReferenceValue10min", "Grd_Sets_ReactPwr_FactorValue10Min", "Grd_Sets_ReactPwr_Source10Min", "HCnt_TotAccumulated_Tot", "HCnt_TotAccumulated_GrdOn", "HCnt_TotAccumulated_GrdOk", "HCnt_TotAccumulated_TrbOk", "HCnt_TotAccumulated_Run", "HCnt_TotAccumulated_Gen1", "HCnt_TotAccumulated_Gen2", "HCnt_TotAccumulated_Yaw", "HCnt_TotAccumulated_SrvOn", "HCnt_TotAccumulated_AmbOk", "HCnt_TotAccumulated_WindOk", "Prod_TotAccumulated_ActPwrGen0", "Prod_TotAccumulated_ActPwrGen1", "Prod_TotAccumulated_ActPwrGen2", "Prod_TotAccumulated_TotActPwr", "Prod_TotAccumulated_ReactPwrGen0", "Prod_TotAccumulated_ReactPwrGen1", "Prod_TotAccumulated_ReactPwrGen2", "Prod_TotAccumulated_TotReactPwr", "Grd_Prod_Pwr_InternalDerateStat", "Grd_Prod_Pwr_InternalDerateChanges", "Grd_Prod_Pwr_InternalDerateTime", "Sys_Stats_TrbStat", "Grd_Sets_ActPwr_MaxReferenceValue10Min", "Grd_Sets_ActPwr_MinReferenceValue10Min", "Grd_Sets_ActPwr_DerateTime10Min", "Grd_Sets_ActPwr_RmtDerateTime10Min", "Amb_NA_CurrentMainWS", "TowerAcc_X_direction_AvgXAcc", "TowerAcc_X_direction_MaxXAcc", "TowerAcc_X_direction_MinXAcc", "TowerAcc_X_direction_StdXAcc", "TowerAcc_Y_direction_AvgYAcc", "TowerAcc_Y_direction_MaxYAcc", "TowerAcc_Y_direction_MinYAcc", "TowerAcc_Y_direction_StdYAcc", "Gear_MainBear_Temp_Avg", "Gear_Bear_TempA_Avg", "Gear_Bear_TempB_Avg", "Gear_Bear_TempC_Avg", "Yaw_Counters_ContactorK100_TotCount", "Yaw_Counters_ContactorK101_TotCount", "Hyd_Counters_MotrContactorK204_TotCount", "HCHeatValveContactorD217_TotCount", "HCRelifValveContactorD250_TotCount", "HCFanLowSpeedContactorK307_TotCount", "HCFanMediumSpeedContactorK313_TotCount", "HCFanHighSpeedContactorK317_TotCount", "HCFBGearOilPumpCont410_TotCount", "Grd_Prod_VoltPhse1_Min", "Grd_Prod_VoltPhse2_Min", "Grd_Prod_VoltPhse3_Min", "Grd_Prod_CurPhse1_Max", "Grd_Prod_CurPhse2_Max", "Grd_Prod_CurPhse3_Max", "Grd_RtrInvPhase1_Current_Avg", "Grd_RtrInvPhase1_Current_Maxium", "Grd_RtrInvPhase2_Current_Avg", "Grd_RtrInvPhase2_Current_Max", "Grd_RtrInvPhase3_Current_Avg", "Grd_RtrInvPhase3_Current_Max", "Hyd_Oil_Pressure_Avg", "Hyd_Oil_Pressure_Min", "Hyd_Oil_Pressure_Std", "Amb_WindDir_Relative_Min", "Amb_WindDir_Relative_Maxium", "Amb_WindDir_Relative_Std", "Gear_Oil_RoughFilt_Min", "Gear_Oil_RoughFilt_Max", "Gear_Oil_RoughFilt_Avg", "Gear_Oil_FineFilt_Min", "Gear_Oil_FineFilt_Max", "Gear_Oil_FineFilt_Avg", "Gear_Oil_OilFlow_Min", "Gear_Oil_OilFlow_Max", "Gear_Oil_OilFlow_Avg", "Blds_BladeA_CntlVolt_Avg", "Blds_BladeA_CntlVolt_Max", "Blds_BladeA_CntlVolt_Min", "Blds_BladeA_CntlVolt_Std", "Blds_BladeB_CntlVolt_Avg", "Blds_BladeB_CntlVolt_Max", "Blds_BladeB_CntlVolt_Min", "Blds_BladeB_CntlVolt_Std", "Blds_BladeC_CntlVolt_Avg", "Blds_BladeC_CntlVolt_Max", "Blds_BladeC_CntlVolt_Min", "Blds_BladeC_CntlVolt_Std"];
opts.SelectedVariableNames = ["PCTimeStamp", "Gen_RPM_Avg", "Gen_Bear_Temp_Avg", "Gear_Bear_Temp_Avg", "Rtr_RPM_Avg", "Amb_WindSpeed_Avg", "Amb_Temp_Avg", "Grd_Prod_Pwr_Avg", "HCnt_Avg_SrvOn","HCnt_Avg_Run"];
opts.VariableTypes = ["string", "datetime", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical", "categorical"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";

% Specify variable properties
opts = setvaropts(opts, "Var1", "WhitespaceRule", "preserve");
opts = setvaropts(opts, ["Var1", "Amb_NA_CurrentMainWS", "TowerAcc_X_direction_AvgXAcc", "TowerAcc_X_direction_MaxXAcc", "TowerAcc_X_direction_MinXAcc", "TowerAcc_X_direction_StdXAcc", "TowerAcc_Y_direction_AvgYAcc", "TowerAcc_Y_direction_MaxYAcc", "TowerAcc_Y_direction_MinYAcc", "TowerAcc_Y_direction_StdYAcc", "Gear_MainBear_Temp_Avg", "Gear_Bear_TempA_Avg", "Gear_Bear_TempB_Avg", "Gear_Bear_TempC_Avg", "Yaw_Counters_ContactorK100_TotCount", "Yaw_Counters_ContactorK101_TotCount", "Hyd_Counters_MotrContactorK204_TotCount", "HCHeatValveContactorD217_TotCount", "HCRelifValveContactorD250_TotCount", "HCFanLowSpeedContactorK307_TotCount", "HCFanMediumSpeedContactorK313_TotCount", "HCFanHighSpeedContactorK317_TotCount", "HCFBGearOilPumpCont410_TotCount", "Grd_Prod_VoltPhse1_Min", "Grd_Prod_VoltPhse2_Min", "Grd_Prod_VoltPhse3_Min", "Grd_Prod_CurPhse1_Max", "Grd_Prod_CurPhse2_Max", "Grd_Prod_CurPhse3_Max", "Grd_RtrInvPhase1_Current_Avg", "Grd_RtrInvPhase1_Current_Maxium", "Grd_RtrInvPhase2_Current_Avg", "Grd_RtrInvPhase2_Current_Max", "Grd_RtrInvPhase3_Current_Avg", "Grd_RtrInvPhase3_Current_Max", "Hyd_Oil_Pressure_Avg", "Hyd_Oil_Pressure_Min", "Hyd_Oil_Pressure_Std", "Amb_WindDir_Relative_Min", "Amb_WindDir_Relative_Maxium", "Amb_WindDir_Relative_Std", "Gear_Oil_RoughFilt_Min", "Gear_Oil_RoughFilt_Max", "Gear_Oil_RoughFilt_Avg", "Gear_Oil_FineFilt_Min", "Gear_Oil_FineFilt_Max", "Gear_Oil_FineFilt_Avg", "Gear_Oil_OilFlow_Min", "Gear_Oil_OilFlow_Max", "Gear_Oil_OilFlow_Avg", "Blds_BladeA_CntlVolt_Avg", "Blds_BladeA_CntlVolt_Max", "Blds_BladeA_CntlVolt_Min", "Blds_BladeA_CntlVolt_Std", "Blds_BladeB_CntlVolt_Avg", "Blds_BladeB_CntlVolt_Max", "Blds_BladeB_CntlVolt_Min", "Blds_BladeB_CntlVolt_Std", "Blds_BladeC_CntlVolt_Avg", "Blds_BladeC_CntlVolt_Max", "Blds_BladeC_CntlVolt_Min", "Blds_BladeC_CntlVolt_Std"], "EmptyFieldRule", "auto");
opts = setvaropts(opts, "PCTimeStamp", "InputFormat", "yyyy-MM-dd HH:mm:ss");

% Import the data
WTG = readtable(filename, opts);

end